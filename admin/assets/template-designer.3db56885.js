var re=Object.defineProperty,ie=Object.defineProperties;var de=Object.getOwnPropertyDescriptors;var Z=Object.getOwnPropertySymbols;var ce=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var ee=(e,t,r)=>t in e?re(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,B=(e,t)=>{for(var r in t||(t={}))ce.call(t,r)&&ee(e,r,t[r]);if(Z)for(var r of Z(t))pe.call(t,r)&&ee(e,r,t[r]);return e},z=(e,t)=>ie(e,de(t));var te=(e,t,r)=>new Promise((g,p)=>{var _=n=>{try{l(r.next(n))}catch(o){p(o)}},s=n=>{try{l(r.throw(n))}catch(o){p(o)}},l=n=>n.done?g(n.value):Promise.resolve(n.value).then(_,s);l((r=r.apply(e,t)).next())});import{d as F,u as V,x as j,y as H,b as U,G as O,t as T,o as m,h as $,j as A,p as ue,r as f,c as w,l as c,v as u,B as P,F as E,L as D,n as _e,M as ne,C as oe,a5 as me,k as Q,Q as fe,w as J,f as ge,I as he,a as be,a6 as x,a7 as K,a8 as ye,a9 as ve,aa as ke,U as X,V as le,D as we,ab as Ce,q as $e,s as De}from"./vendor.d2064af5.js";import{_ as L,b as Ie}from"./componentInstall.9439a8f3.js";import{b as Ne}from"./template.5cb4ac02.js";const se=(e,t,r)=>(e[t]=e.splice(r,1,e[t])[0],e),Se=(e,t)=>t!=0?se(e,t,t-1):e,Be=(e,t,r)=>t+1!=r?se(e,t,t+1):e,Y=()=>{const e=(_,s,l=!1)=>{for(let n=s.length-1;n>=0;n--)if(s[n].id==_){s.splice(n,1),l=!0;break}else if(s[n].children&&s[n].children.length>0&&(l=e(_,s[n].children,l),l))break;return l},t=(_,s,l=null)=>{let n=typeof s.children!="undefined"?s.children:s;for(const o of n)if(o.id==_.id){l=s;break}else if(o.children&&o.children.length>0&&(l=t(_,o,l),l))break;return l},r=(_,s,l)=>{for(const n of s)if(n.id==_){l=n;break}else if(n.children&&n.children.length>0&&(l=r(_,n.children,l),l))break;return l},g=(_,s,l,n=!1)=>{let o=typeof s.children!="undefined"?s.children:s;for(const a in o)if(o[a].id==_.id){l?o=Se(o,Number(a)):o=Be(o,Number(a),o.length),n=!0;break}else if(o[a].children&&o[a].children.length>0&&(t(_,o[a],n),n))break;return s},p=(_,s="",l=0)=>(_.forEach(n=>{let o="";l>0&&(o=" ".repeat(l*2));let a=o+"<"+n.name;n.model&&n.model!=""&&(a+=' :model="'+n.model+'"');for(const b in n.props){const i=n.props[b];n.name=="el-input"&&n.props.type!="textarea"&&b=="rows"||(typeof i=="string"&&i!=""&&(a+=" "+b+'="'+i+'"'),typeof i=="number"&&i!=0&&(a+=" :"+b+'="'+i+'"'),typeof i=="boolean"&&i&&(a+=" :"+b+'="'+i.toString()+'"'))}switch(n.style&&n.style!=""&&(a+=' style="'+n.style+'"'),s+=a+`>
`,n.text&&n.text!=""&&(s+="   "+o+n.text+`
`),n.name){}if(n.children&&n.children.length>0){let b=l;l++,s=p(n.children,s,l),l=b}s+=o+"</"+n.name+`>
`}),s);return{_handleRecursionDelete:e,_handleRecursionGetParentNode:t,_handleRecursionGetNodeByNodeId:r,_handleRecursionMoveNode:g,_generateCode:p}};const Te=F({name:"CmsImage",components:{},props:{id:{type:String,default:""},class:{type:String,default:""},src:{type:String,default:""}},setup(e){V(),j(),H();const t=U({classes:O({get(){return"cms-image"+(e.class==""?"":" "+e.class)}})});let r=U({});return B(B({},T(r)),T(t))}}),Ue=["id"],Ae=["src"];function Ee(e,t,r,g,p,_){return m(),$("div",{id:e.id,class:"img-box"},[A("img",{class:ue(e.classes),src:e.src,draggable:"false"},null,10,Ae)],8,Ue)}var Fe=L(Te,[["render",Ee],["__scopeId","data-v-115ad837"]]);const Le=F({name:"CmsImageTextRow",components:{},props:{id:{type:String,default:""},fontSize:{type:Number,default:18},items:{type:Array,default:[]}},setup(e){const t=V();j(),H();const{_handleRecursionGetNodeByNodeId:r}=Y(),g=U({style:O({get(){let s="";return s+="font-size:"+e.fontSize+"px;",s}})});let p=U({component_tree_list:t.state.component_tree_list});const _=(s,l)=>{const n=r(e.id,p.component_tree_list);n.props.items[l].text=s.target.innerHTML,t.dispatch("handleChangeCurrentNodeInfo",n)};return z(B(B({},T(p)),T(g)),{handleBlur:_})}}),Me={class:"item-box-img-box"},ze=["src"],Ve=["innerHTML","onBlur"];function Oe(e,t,r,g,p,_){const s=f("el-col"),l=f("el-row"),n=f("el-container");return m(),w(n,{id:e.id,class:"cms-image-text-row",direction:"vertical"},{default:c(()=>[u(l,{justify:"center",align:"middle",type:"flex"},{default:c(()=>[u(s,{span:15},{default:c(()=>[u(l,{justify:"space-between",type:"flex"},{default:c(()=>[(m(!0),$(E,null,P(e.items,(o,a)=>(m(),w(s,{key:a,class:"item-box",span:Math.floor(24/e.items.length)},{default:c(()=>[A("div",Me,[o.src?(m(),$("img",{key:0,src:o.src,draggable:"false"},null,8,ze)):D("",!0)]),o.text?(m(),$("div",{key:0,class:"item-box-text",contenteditable:"true",innerHTML:o.text,style:_e(e.style),onBlur:b=>e.handleBlur(b,a)},null,44,Ve)):D("",!0)]),_:2},1032,["span"]))),128))]),_:1})]),_:1})]),_:1})]),_:1},8,["id"])}var Re=L(Le,[["render",Oe],["__scopeId","data-v-a310a216"]]);const je=F({name:"ComponentTree",components:{CmsImage:Fe,CmsImageTextRow:Re},props:{component_tree_list:{type:Array,default:()=>[]}},setup(e,{emit:t}){const r=V(),{_handleRecursionDelete:g,_handleRecursionGetParentNode:p,_handleRecursionGetNodeByNodeId:_}=Y();let s=U({sotre_component_tree_list:r.state.component_tree_list,show_border:!0});const l=i=>{},n=(i,I)=>{let d=null;if(i.id=="block_node"&&(d=p(i,s.sotre_component_tree_list),i=d),!d){g("block_node",s.sotre_component_tree_list);let h={id:"block_node",title:"\u5360\u4F4D\u5757",name:"el-row",props:{},style:"flex-grow: 1;height:100%;max-height:80px;border:1px dashed #cccccc;box-sizing:border-box;background:#fafafa;"};if(i.children){const v=document.getElementById(i.id),k=(y,C=0)=>{C=y.offsetTop;let S=y.offsetParent;return S!=null&&(C+=S.offsetTop,k(S,C)),C};if(I.clientY+document.getElementById("designer").scrollTop>=k(v)-1&&I.clientY+document.getElementById("designer").scrollTop<=k(v)+1){d=p(i,s.sotre_component_tree_list),d.children&&(d=d.children);let y=0;for(let C=0;C<d.length;C++)if(d[C].id==i.id){y=C;break}d.splice(y,0,h)}else i.children.push(h)}else i.push(h)}},o=(i,I)=>{let d=null,h=null,v=0,k=!1;if(i.id=="block_node"){d=p(i,s.sotre_component_tree_list),k=!0,h=d.children?d.children:d;for(let C=0;C<h.length;C++)if(h[C].id==i.id){v=C;break}i=d}g("block_node",s.sotre_component_tree_list);let y=JSON.parse(I.dataTransfer.getData("node"));if(k){d.children?i.allow?d.children.splice(v,0,y):y={props:{}}:d.splice(v,0,y),r.dispatch("handleChangeCurrentNodeInfo",y);return}if(i.children){const C=document.getElementById(i.id);if(I.clientY+document.getElementById("designer").scrollTop==C.offsetTop){d=p(i,s.sotre_component_tree_list),d.children&&(d=d.children);let S=0;for(let M=0;M<d.length;M++)if(d[M].id==i.id){S=M;break}d.splice(S,0,y)}else i.allow?i.children.push(y):y={props:{}}}else i.push(y);r.dispatch("handleChangeCurrentNodeInfo",y)},a=i=>[].includes(i.name)&&r.state.show_border?"padding":"",b=i=>{const I=(h,v=0)=>h.target&&h.target.id?h.target.id:h.id?h.id:v>5?!1:(v++,I(h.target?h.target.parentElement:h.parentElement,v));let d=I(i);if(d){let h=_(d,s.sotre_component_tree_list);r.dispatch("handleChangeCurrentNodeInfo",h);let v=document.getElementsByClassName("border")[0];v&&(v.className=v.className.replace(" border",""));let k=document.getElementById(r.state.current_node_info.id);k&&(k.className=k.className+" border")}};return z(B({},T(s)),{handleDragEnterOnNode:l,handleDragOverOnNode:n,handleDropOnNode:o,handleShowBorder:a,handleClick:b})}});function He(e,t,r,g,p,_){const s=f("component-tree",!0);return m(!0),$(E,null,P(e.component_tree_list,(l,n)=>(m(),w(fe(l.name),me({key:l.id+n,id:l.id},l.props,{modelValue:l.value,"onUpdate:modelValue":o=>l.value=o,class:e.handleShowBorder(l),style:l.style,draggable:!1,onDragenter:Q(e.handleDragEnterOnNode,["stop","prevent"]),onDragover:Q(o=>e.handleDragOverOnNode(l,o),["stop","prevent"]),onDrop:Q(o=>e.handleDropOnNode(l,o),["stop","prevent"]),onClick:Q(e.handleClick,["stop","prevent"])}),{default:c(()=>[ne(oe(l.text)+" ",1),l.children?(m(),w(s,{key:0,component_tree_list:l.children},null,8,["component_tree_list"])):D("",!0)]),_:2},1040,["id","modelValue","onUpdate:modelValue","class","style","onDragenter","onDragover","onDrop","onClick"]))),128)}var xe=L(je,[["render",He],["__scopeId","data-v-6375d346"]]);const Pe=F({name:"Designer",components:{ComponentTree:xe},setup(){const e=V();j();const t=H(),{_handleRecursionDelete:r,_handleRecursionMoveNode:g}=Y(),p=U({attribute:O({get(){return e.state.current_node_info.props},set(d){}}),component_tree_list:O({get(){return e.state.component_tree_list},set(d){e.dispatch("handleChangeComponentTreeList",d)}})});J(T(p).attribute,(d,h)=>{he(()=>{let v=document.getElementsByClassName("border")[0];v&&(v.className=v.className.replace(" border","")),document.getElementById("toolbar")&&document.getElementById("toolbar").remove();let k=document.getElementById(e.state.current_node_info.id);if(k){k.className=k.className+" border";let y=document.createElement("div");y.id="toolbar",y.style="position: relative;top: 0;height: 0;z-index: 100;width: 100%;",k.before(y),be({setup(R){return{}},render(){return x("div",{id:"toolbar-bar"},[x(K,{id:"move-up-btn"},{default:R=>x(ye)}),x(K,{id:"move-down-btn"},{default:R=>x(ve)}),x(K,{id:"delete-control-btn"},{default:R=>x(ke)})])}}).mount(y);let S=document.getElementById("toolbar-bar");S.style="background: rgba(0,0,0,0.5);display: flex;justify-content: end;padding: 10px;align-items: center;";const M=document.getElementById("move-up-btn"),q=document.getElementById("move-down-btn"),N=document.getElementById("delete-control-btn");M.onclick=()=>{i(!0)},q.onclick=()=>{i(!1)},N.onclick=()=>{b()}}})},{deep:!0});let _=U({ruleForm:{id:t.query.id}});ge(()=>{_.ruleForm.id&&s()});const s=()=>{Ne({id:_.ruleForm.id}).then(d=>{p.component_tree_list=d.data.component_tree_list}).catch(()=>{})},l=d=>{},n=d=>{d.preventDefault();let h=!1,v=d.clientY+document.getElementById("designer").scrollTop;for(let y=0;y<p.component_tree_list.length;y++){const C=p.component_tree_list[y],S=document.getElementById(C.id);if(y==0&&v<S.offsetTop){h=!0,_.insert_index=0;break}else if(v<S.offsetTop+S.offsetHeight/2){h=!0,_.insert_index=y;break}else if(y==p.component_tree_list.length-1&&!h){_.insert_index=y+1;break}}r("block_node",p.component_tree_list);let k={id:"block_node",title:"",name:"el-row",props:{},style:"flex-grow: 1;height:100%;max-height:80px;border:1px dashed #cccccc;box-sizing:border-box;background:#fafafa;"};p.component_tree_list.splice(_.insert_index,0,k)},o=d=>{},a=d=>{d.preventDefault(),r("block_node",p.component_tree_list);let h=JSON.parse(d.dataTransfer.getData("node"));p.component_tree_list.splice(_.insert_index,0,h),e.dispatch("handleChangeCurrentNodeInfo",h)},b=()=>{e.state.current_node_info.id&&(r(e.state.current_node_info.id,p.component_tree_list),e.dispatch("handleChangeCurrentNodeInfo",{props:{}}))},i=d=>{let h=e.state.current_node_info;h.id&&(p.component_tree_list=g(h,p.component_tree_list,d),e.dispatch("handleChangeCurrentNodeInfo",{props:{}}),e.dispatch("handleChangeCurrentNodeInfo",h))},I=d=>{if(d.target.id=="designer"){let h=document.getElementsByClassName("border")[0];h&&(h.className=h.className.replace(" border","")),e.dispatch("handleChangeCurrentNodeInfo",{props:{}})}};return z(B(B({},T(_)),T(p)),{handleDragEnter:l,handleDragOver:n,handleDragLeave:o,handleDrop:a,handleClick:I})}});function Ge(e,t,r,g,p,_){const s=f("component-tree"),l=f("el-empty"),n=f("el-container"),o=f("el-main");return m(),w(o,{class:"designer-container"},{default:c(()=>[u(n,{class:"designer-container-box"},{default:c(()=>[A("div",{id:"designer",onDragenter:t[0]||(t[0]=(...a)=>e.handleDragEnter&&e.handleDragEnter(...a)),onDragover:t[1]||(t[1]=(...a)=>e.handleDragOver&&e.handleDragOver(...a)),onDragleave:t[2]||(t[2]=(...a)=>e.handleDragLeave&&e.handleDragLeave(...a)),onDrop:t[3]||(t[3]=(...a)=>e.handleDrop&&e.handleDrop(...a)),onClick:t[4]||(t[4]=(...a)=>e.handleClick&&e.handleClick(...a))},[e.component_tree_list.length!=0?(m(),w(s,{key:0,component_tree_list:e.component_tree_list},null,8,["component_tree_list"])):(m(),w(l,{key:1,description:"\u8BD5\u8BD5\u5F80\u91CC\u9762\u62D6\u4E00\u4E2A\u7EC4\u4EF6"}))],32)]),_:1})]),_:1})}var qe=L(Pe,[["render",Ge],["__scopeId","data-v-50f7fb32"]]);const Qe={components:[{title:"\u57FA\u7840\u6A21\u5757",type:"Basic",children:[{name:"cms-image",title:"\u56FE\u7247\u7EC4\u4EF6",props:{src:"https://2.ss.faisys.com/image/materialLib/image/3000338.jpg?v=201712181730"},allow:!1,children:[]},{name:"cms-image-text-row",title:"\u56FE\u7247\u6587\u5B57\u7EC4\u4EF6",props:{fontSize:18,items:[{src:"https://1.s140i.faiusr.com/2/AIwBCAAQAhgAILqXm9oFKNDHvkowgA84gAo!500x500.jpg",text:"\u9884\u6D4B\u4F01\u4E1A\u672A\u6765\u7684\u7ECF\u8425\u65B9\u7565\uFF0C\u4E0D\u65AD\u5730\u8FDB\u884C\u66F4\u65B0\u3002\u4F01\u4E1A\u7684\u4E1A\u52A1\u53D1\u751F\u53D8\u5316\u65F6\uFF0C\u4E5F\u4E0D\u9700\u8981\u989D\u5916\u8FDB\u884C\u7CFB\u7EDF\u5F00\u53D1\uFF0C\u4FBF\u53EF\u4F7F\u7528\u5BF9\u5E94\u529F\u80FD\u3002\u901A\u8FC7\u4E0D\u61C8\u5730\u53D1\u5C55\uFF0C\u4E0D\u4EC5\u662F\u73B0\u5728\uFF0C\u5728\u672A\u676510\u5E74\u4E5F\u53EF\u4EE5\u901A\u8FC7\u6211\u4EEC\u7BA1\u7406\u4F01\u4E1A\u7684\u6240\u6709\u4E1A\u52A1\u3002"},{src:"https://1.s140i.faiusr.com/2/AIwBCAAQAhgAILqXm9oFKNDHvkowgA84gAo!500x500.jpg",text:"\u9884\u6D4B\u4F01\u4E1A\u672A\u6765\u7684\u7ECF\u8425\u65B9\u7565\uFF0C\u4E0D\u65AD\u5730\u8FDB\u884C\u66F4\u65B0\u3002\u4F01\u4E1A\u7684\u4E1A\u52A1\u53D1\u751F\u53D8\u5316\u65F6\uFF0C\u4E5F\u4E0D\u9700\u8981\u989D\u5916\u8FDB\u884C\u7CFB\u7EDF\u5F00\u53D1\uFF0C\u4FBF\u53EF\u4F7F\u7528\u5BF9\u5E94\u529F\u80FD\u3002\u901A\u8FC7\u4E0D\u61C8\u5730\u53D1\u5C55\uFF0C\u4E0D\u4EC5\u662F\u73B0\u5728\uFF0C\u5728\u672A\u676510\u5E74\u4E5F\u53EF\u4EE5\u901A\u8FC7\u6211\u4EEC\u7BA1\u7406\u4F01\u4E1A\u7684\u6240\u6709\u4E1A\u52A1\u3002"},{src:"https://1.s140i.faiusr.com/2/AIwBCAAQAhgAILqXm9oFKNDHvkowgA84gAo!500x500.jpg",text:"\u9884\u6D4B\u4F01\u4E1A\u672A\u6765\u7684\u7ECF\u8425\u65B9\u7565\uFF0C\u4E0D\u65AD\u5730\u8FDB\u884C\u66F4\u65B0\u3002\u4F01\u4E1A\u7684\u4E1A\u52A1\u53D1\u751F\u53D8\u5316\u65F6\uFF0C\u4E5F\u4E0D\u9700\u8981\u989D\u5916\u8FDB\u884C\u7CFB\u7EDF\u5F00\u53D1\uFF0C\u4FBF\u53EF\u4F7F\u7528\u5BF9\u5E94\u529F\u80FD\u3002\u901A\u8FC7\u4E0D\u61C8\u5730\u53D1\u5C55\uFF0C\u4E0D\u4EC5\u662F\u73B0\u5728\uFF0C\u5728\u672A\u676510\u5E74\u4E5F\u53EF\u4EE5\u901A\u8FC7\u6211\u4EEC\u7BA1\u7406\u4F01\u4E1A\u7684\u6240\u6709\u4E1A\u52A1\u3002"}]},allow:!1,children:[]}]},{title:"\u9AD8\u7EA7\u6A21\u5757",type:"Advanced",children:[]}]};var Ye="/admin/assets/cms-image.fc0dcb6c.png",Je="/admin/assets/cms-image-text-row.0c4b5bc1.png";const Ke=F({name:"Template",components:{},setup(){const e=V();j(),H();const{_handleRecursionDelete:t}=Y();let r=U({component_type:"Basic",component_images:{cms_image:Ye,cms_image_text_row:Je}});const g=s=>{},p=(s,l)=>{s.id="node-"+new Date().getTime(),s.children.forEach(n=>{n.id="node-"+new Date().getTime()}),l.dataTransfer.setData("node",JSON.stringify(s))},_=s=>{t("block_node",e.state.component_tree_list)};return z(B({},T(r)),{components_list:Qe,handleChangeTab:g,handleDragStart:p,handleDragEnterContrlList:_})}}),Xe=["onDragstart"],We=["src","title"],Ze=["src","title"];function et(e,t,r,g,p,_){const s=f("el-tab-pane"),l=f("el-tabs"),n=f("el-aside");return m(),w(n,{class:"control-bar",width:"200px"},{default:c(()=>[u(l,{id:"components-window-tab",type:"border-card",modelValue:e.component_type,"onUpdate:modelValue":t[0]||(t[0]=o=>e.component_type=o),onTabClick:e.handleChangeTab,onDragenter:e.handleDragEnterContrlList},{default:c(()=>[(m(!0),$(E,null,P(e.components_list.components,(o,a)=>(m(),w(s,{key:a,class:"components-window-tab-content",label:o.title,name:o.type},{default:c(()=>[(m(!0),$(E,null,P(o.children,(b,i)=>(m(),$("div",{key:i,class:"component",draggable:!0,onDragstart:I=>e.handleDragStart(b,I)},[b.name=="cms-image"?(m(),$("img",{key:0,class:"component-image",src:e.component_images.cms_image,title:b.title},null,8,We)):D("",!0),b.name=="cms-image-text-row"?(m(),$("img",{key:1,class:"component-image",src:e.component_images.cms_image_text_row,title:b.title},null,8,Ze)):D("",!0)],40,Xe))),128))]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue","onTabClick","onDragenter"])]),_:1})}var tt=L(Ke,[["render",et],["__scopeId","data-v-2cb591d7"]]);function ae(e){return Ie({url:"/Upload/FileUpload",method:"post",headers:{"Content-Type":"multipart/form-data"},data:e})}const nt=F({name:"Upload",components:{},props:{file:{type:String,default:""},fileType:{type:String,default:"image/*"},multiple:{type:Boolean,defalut:!1},limit:{type:Number,default:3},files:{type:Array,default:function(){return[]}}},emits:["handleUploadSuccess","handleDeleteFile","handleClickDeleteMultiple","handleUploadMultipleSuccess"],setup(e,{emit:t}){const{proxy:r}=we();let g=U({imgUrl:"",imgList:[],isShowOpt:!1});J(()=>e.file,n=>{g.imgUrl=n},{immediate:!0}),J(()=>e.files,n=>{g.imgList=[],n.forEach(o=>{g.imgList.push({url:o,isShowMask:!1})})},{immediate:!0});const p=n=>{let o=new FormData;o.append("file",n),ae(o).then(a=>{g.imgUrl=a.data.imgUrl,r.$message({message:"\u4E0A\u4F20\u6210\u529F",type:"success",onClose:function(){}}),t("handleUploadSuccess",g.imgUrl)}).catch(()=>{})},_=()=>{g.imgUrl="",t("handleDeleteFile")},s=n=>{g.imgList.splice(n,1);let o=[...g.imgList].map(a=>a.url);t("handleClickDeleteMultiple",o)},l=n=>{if(n.length+g.imgList.length>e.limit)return r.$message({type:"error",message:"\u6700\u591A\u53EF\u4E0A\u4F20"+e.limit+"\u5F20"}),!1;new Promise(o=>{Array.from(n).forEach((a,b)=>te(this,null,function*(){let i=new FormData;i.append("file",a),yield ae(i).then(I=>{g.imgList.push({url:I.data.imgUrl,isShowMask:!1}),b==n.length-1&&o()}).catch(()=>{})}))}).then(()=>{r.$message({type:"success",message:"\u56FE\u7247\u5217\u8868\u4E0A\u4F20\u6210\u529F"});let o=[...g.imgList].map(a=>a.url);t("handleUploadMultipleSuccess",o)})};return z(B({},T(g)),{handleUploadFile:p,handleClickDelete:_,handleClickDeleteMultiple:s,handleUploadFiles:l})}}),ot={class:"upload-file-commpent"},lt=["src"],st={class:"opt"},at=["accept"],rt=["onMouseenter","onMouseleave"],it=["src"],dt={class:"opt"},ct=["accept","multiple"];function pt(e,t,r,g,p,_){const s=f("delete"),l=f("el-icon"),n=f("plus");return m(),$("div",ot,[e.multiple?D("",!0):(m(),$(E,{key:0},[e.imgUrl?(m(),$("div",{key:0,class:"uplaod-file-preview",onMouseenter:t[1]||(t[1]=o=>e.isShowOpt=!0),onMouseleave:t[2]||(t[2]=o=>e.isShowOpt=!1)},[A("img",{src:e.imgUrl,alt:"\u4E0A\u4F20\u6210\u529F\u56FE\u7247"},null,8,lt),X(A("div",st,[u(l,{class:"delete-btn",onClick:t[0]||(t[0]=o=>e.handleClickDelete())},{default:c(()=>[u(s)]),_:1})],512),[[le,e.isShowOpt]])],32)):D("",!0),e.imgUrl?D("",!0):(m(),$("div",{key:1,class:"upload-file-btn",onClick:t[4]||(t[4]=o=>e.$refs.file.click())},[u(l,null,{default:c(()=>[u(n)]),_:1}),A("input",{ref:"file",type:"file",class:"upload-file-input",accept:e.fileType,onChange:t[3]||(t[3]=o=>e.handleUploadFile(o.target.files[0]))},null,40,at)]))],64)),e.multiple?(m(),$(E,{key:1},[(m(!0),$(E,null,P(e.imgList,(o,a)=>(m(),$("div",{key:a,class:"uplaod-file-preview",onMouseenter:b=>o.isShowMask=!0,onMouseleave:b=>o.isShowMask=!1},[A("img",{src:o.url,alt:"\u4E0A\u4F20\u6210\u529F\u56FE\u7247"},null,8,it),X(A("div",dt,[u(l,{class:"delete-btn",onClick:b=>e.handleClickDeleteMultiple(a)},{default:c(()=>[u(s)]),_:2},1032,["onClick"])],512),[[le,o.isShowMask]])],40,rt))),128)),e.imgList.length<e.limit?(m(),$("div",{key:0,class:"upload-file-btn",onClick:t[6]||(t[6]=o=>e.$refs.files.click())},[u(l,null,{default:c(()=>[u(n)]),_:1}),A("input",{ref:"files",type:"file",class:"upload-file-input",accept:e.fileType,multiple:e.multiple,onChange:t[5]||(t[5]=o=>e.handleUploadFiles(o.target.files))},null,40,ct)])):D("",!0)],64)):D("",!0)])}var ut=L(nt,[["render",pt],["__scopeId","data-v-633f404f"]]);const _t=F({name:"Attribute",components:{Upload:ut},props:{showAttributeDialog:{type:Boolean,default:!0}},emits:["handleCloseDialog"],setup(e,{emit:t}){const r=V();j(),H();const g=U({node_info:O({get(){return r.state.current_node_info},set(a){}}),attribute:O({get(){return r.state.current_node_info.props},set(a){}})});let p=U({tab_active_name:"1",show_setting_dialog:!1});const _=()=>{t("handleCloseDialog")},s=a=>{a.length<8&&a.push(a[0])},l=(a,b)=>{a.length>1&&a.splice(b,1)},n=(a,b)=>{b.src=a},o=a=>{a.src=""};return z(B(B({},T(p)),T(g)),{handleCloseDialog:_,handleClickAddCmsImageTextItem:s,handleClickDeleteCmsImageTextItem:l,handleUploadSuccess:n,handleDeleteFile:o})}}),mt={id:"attibute_setting_dialog"};function ft(e,t,r,g,p,_){const s=f("upload"),l=f("el-row"),n=f("el-form-item"),o=f("el-input-number"),a=f("setting"),b=f("el-icon"),i=f("el-button"),I=f("el-form"),d=f("el-tab-pane"),h=f("el-tabs"),v=f("el-input"),k=f("el-col"),y=f("minus"),C=f("plus"),S=f("el-dialog"),M=f("el-aside"),q=Ce("el-drag-dialog");return m(),w(M,{class:"attribute",width:"300px"},{default:c(()=>[u(h,{id:"attribute-window-tab",type:"border-card",modelValue:e.tab_active_name,"onUpdate:modelValue":t[4]||(t[4]=N=>e.tab_active_name=N)},{default:c(()=>[u(d,{class:"attribute-window-tab-content",name:"1",label:"\u5C5E\u6027\u680F"},{default:c(()=>[A("h4",null,oe(e.node_info.title),1),u(I,{ref:"attribute",model:e.attribute,"label-width":"68px"},{default:c(()=>[e.node_info.name=="cms-image"?(m(),w(n,{key:0,label:"\u56FE\u7247\u8BBE\u7F6E"},{default:c(()=>[u(l,{class:"block-margin",justify:"start",align:"middle",type:"flex"},{default:c(()=>[u(s,{file:e.attribute.src,onHandleUploadSuccess:t[0]||(t[0]=N=>{e.handleUploadSuccess(N,e.attribute)}),onHandleDeleteFile:t[1]||(t[1]=N=>e.handleDeleteFile(e.attribute))},null,8,["file"])]),_:1})]),_:1})):D("",!0),e.node_info.name=="cms-image-text-row"?(m(),$(E,{key:1},[e.attribute.fontSize?(m(),w(n,{key:0,label:"\u5B57\u4F53\u5927\u5C0F"},{default:c(()=>[u(o,{modelValue:e.attribute.fontSize,"onUpdate:modelValue":t[2]||(t[2]=N=>e.attribute.fontSize=N),controls:!0,min:12,max:24},null,8,["modelValue"])]),_:1})):D("",!0),u(n,{label:"\u9009\u9879\u8BBE\u7F6E"},{default:c(()=>[u(i,{size:"mini",type:"primary",onClick:t[3]||(t[3]=N=>e.show_setting_dialog=!0)},{default:c(()=>[u(b,null,{default:c(()=>[u(a)]),_:1})]),_:1})]),_:1})],64)):D("",!0)]),_:1},8,["model"])]),_:1})]),_:1},8,["modelValue"]),X(A("div",mt,[u(S,{title:e.node_info.title,"model-value":e.show_setting_dialog,onClose:t[6]||(t[6]=N=>e.show_setting_dialog=!1)},{default:c(()=>[u(I,{ref:"attribute",model:e.attribute,"label-width":"68px"},{default:c(()=>[e.node_info.name=="cms-image-text-row"?(m(),w(n,{key:0,label:"\u9009\u9879\u8BBE\u7F6E"},{default:c(()=>[(m(!0),$(E,null,P(e.attribute.items,(N,R)=>(m(),w(l,{key:R,class:"block-margin",justify:"space-between",align:"middle",type:"flex"},{default:c(()=>[u(k,{span:14},{default:c(()=>[u(v,{type:"textarea",modelValue:N.text,"onUpdate:modelValue":G=>N.text=G,placeholder:"\u8BF7\u8F93\u5165\u63CF\u8FF0\u6587\u5B57",rows:4,autosize:!1,resize:"both",clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),u(k,{span:5},{default:c(()=>[u(s,{file:N.src,onHandleUploadSuccess:G=>{e.handleUploadSuccess(G,N)},onHandleDeleteFile:G=>e.handleDeleteFile(N)},null,8,["file","onHandleUploadSuccess","onHandleDeleteFile"])]),_:2},1024),u(k,{span:3},{default:c(()=>[R>0?(m(),w(i,{key:0,size:"mini",type:"danger",onClick:G=>e.handleClickDeleteCmsImageTextItem(e.attribute.items,R)},{default:c(()=>[u(b,null,{default:c(()=>[u(y)]),_:1})]),_:2},1032,["onClick"])):D("",!0)]),_:2},1024)]),_:2},1024))),128)),u(l,null,{default:c(()=>[u(k,{span:4},{default:c(()=>[u(i,{size:"mini",type:"primary",onClick:t[5]||(t[5]=N=>e.handleClickAddCmsImageTextItem(e.attribute.items))},{default:c(()=>[u(b,null,{default:c(()=>[u(C)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):D("",!0)]),_:1},8,["model"])]),_:1},8,["title","model-value"])],512),[[q]])]),_:1})}var gt=L(_t,[["render",ft],["__scopeId","data-v-dc26e8fe"]]);const ht=F({name:"HeaderBar",components:{},setup(){const e=V();j();const t=H(),r=U({is_preview:O({get(){return e.state.is_preview}})});let g=U({ruleForm:{id:t.query.id}});const p=()=>{e.dispatch("handleChangeCurrentNodeInfo",{props:{}}),e.dispatch("handleChangeIsPreview",!e.state.is_preview),console.log(r.is_preview)};return z(B(B({},T(g)),T(r)),{handleChangeIsPreview:p})}}),W=e=>($e("data-v-23e4eb04"),e=e(),De(),e),bt=W(()=>A("span",null,"\u9884\u89C8",-1)),yt=W(()=>A("span",null,"\u4FDD\u5B58\uFF08\u65B0\u589E\uFF09",-1)),vt=W(()=>A("span",null,"\u4FDD\u5B58\uFF08\u7F16\u8F91\uFF09",-1)),kt=ne(" \u9000\u51FA\u9884\u89C8 ");function wt(e,t,r,g,p,_){const s=f("el-button"),l=f("el-row"),n=f("el-container"),o=f("el-header");return m(),$(E,null,[e.is_preview?D("",!0):(m(),w(o,{key:0,class:"header-bar"},{default:c(()=>[u(n,{class:"header-bar-container",direction:"vertical"},{default:c(()=>[u(l,{justify:"center",align:"middle",type:"flex"},{default:c(()=>[u(s,{size:"medium",type:"primary",onClick:e.handleChangeIsPreview},{default:c(()=>[bt]),_:1},8,["onClick"]),e.ruleForm.id?D("",!0):(m(),w(s,{key:0,size:"medium",type:"primary"},{default:c(()=>[yt]),_:1})),e.ruleForm.id?(m(),w(s,{key:1,size:"medium",type:"primary"},{default:c(()=>[vt]),_:1})):D("",!0)]),_:1})]),_:1})]),_:1})),e.is_preview?(m(),w(l,{key:1,class:"preview-bar",justify:"center",align:"middle",type:"flex"},{default:c(()=>[u(s,{size:"medium",type:"primary",onClick:e.handleChangeIsPreview},{default:c(()=>[kt]),_:1},8,["onClick"])]),_:1})):D("",!0)],64)}var Ct=L(ht,[["render",wt],["__scopeId","data-v-23e4eb04"]]);const $t=F({name:"Template",components:{Designer:qe,ControlBar:tt,Attribute:gt,HeaderBar:Ct},setup(){const e=V();j(),H();const t=U({is_preview:O({get(){return e.state.is_preview}})});let r=U({});return B(B({},T(r)),T(t))}});function Dt(e,t,r,g,p,_){const s=f("header-bar"),l=f("control-bar"),n=f("designer"),o=f("attribute"),a=f("el-container");return m(),w(a,{class:"container-layout"},{default:c(()=>[u(s),u(a,{class:"container-content"},{default:c(()=>[e.is_preview?D("",!0):(m(),w(l,{key:0})),u(n),e.is_preview?D("",!0):(m(),w(o,{key:1}))]),_:1})]),_:1})}var Tt=L($t,[["render",Dt],["__scopeId","data-v-958217a0"]]);export{Tt as default};
